Сделай вот что в class.php

1) Добавь к каждой колонке, кроме "Ответственного", подколонку "Балл".
1.1) При этом в колонке "Время для закрытия, дни" сделай отдельно подколонку "Время, дни" и туда выводи те же значения, что выводим сейчас, и отдельно подколонку "Балл"
1.2) А у остальных подколонок (которые у нас называются по этапам лидов):
1.2.1) подколонку "Лиды" переименуй в "Количество"
1.2.2) во второй подколонке "Время (дни)" выводи среднее значение в днях.
Вот как бы писал: "Сейчас в class.php время копится в минутах. В шаблоне мы уже делим на 1440, чтобы вывести дни: TIME / 1440.
Если нужно среднее время в днях, то формула такая:
(сумма минут по этапу) / (количество лидов на этапе) / 1440, то есть TIME / COUNT / 1440."

1.2.3) Добавь третью подколонку "Балл"

2) в фильтре по ответственному добавь ответственных с id = 12, 39, 67, 130, 290 и 2681
То есть, еще 6 человек

3) по каждой колонке (по названиям этапов), включая колонку "Время закрытия, мин" необходимо проставить баллы. Логика следующая:

4.1) Задаем в коде жёстко нормативы для колонок (в паблике не отображаем этого):
норматив по колонке с кодом этапа NEW - 1 день
Норматив по остальным колонкам (включая - 5 дней

4.2) по каждой отдельной колонке смотрим всех пользователей, у кого значение в подколонке "Время (дни)" (то есть, это все колонки, кроме первой) превышает норматив (из пункта 4.1)
4.3) сортируем всех этих пользователей по убыванию и выставь им баллы. Тому, у кого разница между "Время (дни)" с нормативом меньше остальных - выставь 1 балл, следующему (у кого больше разрыв) - 2 балла, следующему - 3 балла, и так далее
Это необходимо делать по каждой отдельной воронке
Если у двух или более юзеров одинаковое время "Время (дни)" и оно выше норматива, то выставь им одинаковое количество баллов.